<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>æŠŠå°äººä¸Ÿä¾†ä¸Ÿå»ï¼ˆäººå½¢ï¼‰</title>
<style>
  body {
    text-align: center;
    background: #f0f0f0;
    font-family: Arial;
  }
  canvas {
    background: white;
    border: 2px solid black;
    cursor: grab;
  }
  button {
    margin-top: 10px;
    padding: 8px 16px;
    font-size: 16px;
  }
</style>
</head>
<body>

<h2>ğŸ§â€â™‚ï¸ æŠŠå°äººä¸Ÿä¾†ä¸Ÿå»ï¼ˆäººå½¢ï¼‹å››è‚¢å‹•ï¼‰</h2>
<canvas id="game" width="600" height="400"></canvas><br>
<button onclick="reset()">å›åˆ°ä¸­å¤®</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let guy = {
  x: 300,
  y: 200,
  vx: 0,
  vy: 0,
  dragging: false,
  walkTime: 0
};

const gravity = 0.5;
const bounce = 0.8;

let lastMouse = { x: 0, y: 0 };

// æ»‘é¼ æŒ‰ä¸‹ï¼ˆæŠ“äººï¼‰
canvas.addEventListener("mousedown", e => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  if (Math.abs(mx - guy.x) < 30 && Math.abs(my - guy.y) < 60) {
    guy.dragging = true;
    guy.vx = 0;
    guy.vy = 0;
    lastMouse.x = mx;
    lastMouse.y = my;
  }
});

// æ‹–æ›³
canvas.addEventListener("mousemove", e => {
  if (!guy.dragging) return;

  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  guy.vx = mx - lastMouse.x;
  guy.vy = my - lastMouse.y;

  guy.x = mx;
  guy.y = my;

  lastMouse.x = mx;
  lastMouse.y = my;
});

// æ”¾æ‰‹ä¸Ÿå‡ºå»
canvas.addEventListener("mouseup", () => {
  guy.dragging = false;
});

// å›åˆ°ä¸­å¤®
function reset() {
  guy.x = canvas.width / 2;
  guy.y = canvas.height / 2;
  guy.vx = 0;
  guy.vy = 0;
}

// æ›´æ–°ç‰©ç†
function update() {
  if (!guy.dragging) {
    guy.vy += gravity;
    guy.x += guy.vx;
    guy.y += guy.vy;

    // ç‰†å£åå½ˆ
    if (guy.x < 20) {
      guy.x = 20;
      guy.vx *= -bounce;
    }
    if (guy.x > canvas.width - 20) {
      guy.x = canvas.width - 20;
      guy.vx *= -bounce;
    }
    if (guy.y < 20) {
      guy.y = 20;
      guy.vy *= -bounce;
    }
    if (guy.y > canvas.height - 20) {
      guy.y = canvas.height - 20;
      guy.vy *= -bounce;
    }
  }
}

// ç¹ªè£½äººå½¢ï¼ˆå››è‚¢æœƒå‹•ï¼‰
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const speed = Math.sqrt(guy.vx * guy.vx + guy.vy * guy.vy);
  guy.walkTime += speed * 0.05;

  const swing = Math.sin(guy.walkTime) * Math.min(speed, 10) * 0.6;

  const x = guy.x;
  const y = guy.y;

  const headR = 10;
  const bodyLen = 28;
  const armLen = 22;
  const legLen = 26;

  ctx.lineWidth = 4;
  ctx.lineCap = "round";
  ctx.strokeStyle = "black";

  // é ­
  ctx.beginPath();
  ctx.arc(x, y - bodyLen - headR, headR, 0, Math.PI * 2);
  ctx.stroke();

  // èº«é«”
  ctx.beginPath();
  ctx.moveTo(x, y - bodyLen);
  ctx.lineTo(x, y);
  ctx.stroke();

  // å·¦æ‰‹
  ctx.beginPath();
  ctx.moveTo(x, y - bodyLen + 5);
  ctx.lineTo(x - armLen, y - bodyLen + 5 + swing);
  ctx.stroke();

  // å³æ‰‹
  ctx.beginPath();
  ctx.moveTo(x, y - bodyLen + 5);
  ctx.lineTo(x + armLen, y - bodyLen + 5 - swing);
  ctx.stroke();

  // å·¦è…³
  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.lineTo(x - 12, y + legLen - swing);
  ctx.stroke();

  // å³è…³
  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.lineTo(x + 12, y + legLen + swing);
  ctx.stroke();
}

// éŠæˆ²ä¸»è¿´åœˆ
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
</body>
</html>
